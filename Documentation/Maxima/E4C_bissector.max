Momega : matrix([cos(omega), 0, -sin(omega)], [0, 1, 0], [sin(omega), 0, cos(omega)]);
Mchi : matrix([1, 0, 0], [0, cos(chi), -sin(chi)], [0, sin(chi), cos(chi)]);
Mphi : matrix([cos(phi), 0, -sin(phi)], [0, 1, 0], [sin(phi), 0, cos(phi)]);
M2theta : matrix([cos(2*theta), 0, -sin(2*theta)],[0, 1, 0],[sin(2*theta), 0, cos(2*theta)]);

R : Momega.Mchi.Mphi;

Q : M2theta.[ki, 0, 0]-[ki, 0, 0];

invert(R).Q, trigexpand = true, expand, omega = theta;

MM : ratsimp(trigsimp(%));
