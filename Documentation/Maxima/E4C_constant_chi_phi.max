Momega : MATRIX([cos(omega), 0, -sin(omega)], [0, 1, 0], [sin(omega), 0, cos(omega)]);
Mchi : MATRIX([1, 0, 0], [0, cos(chi), -sin(chi)], [0, sin(chi), cos(chi)]);
Mphi : MATRIX([cos(phi), 0, -sin(phi)], [0, 1, 0], [sin(phi), 0, cos(phi)]);
M2theta : MATRIX([cos(2*theta), 0, -sin(2*theta)],[0, 1, 0],[sin(2*theta), 0, cos(2*theta)]);

R : Momega.Mchi.Mphi;

Q : M2theta.[ki, 0, 0]-[ki, 0, 0];

TRANSPOSE(R).Q, TRIGEXPAND = TRUE, EXPAND, chi = C1, phi = C2;

MM : RATSIMP(TRIGSIMP(%));
